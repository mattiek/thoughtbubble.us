{% extends 'base.html' %}
{% load classnames %}
{% load widget_tweaks %}

{% block title %}
    Explore
{% endblock %}

{% block head %}
    <link href='//api.tiles.mapbox.com/mapbox.js/v1.4.0/mapbox.css' rel='stylesheet' />
    <!--[if lte IE 8]>
    <link href='//api.tiles.mapbox.com/mapbox.js/v1.4.0/mapbox.ie.css' rel='stylesheet' />
  <![endif]-->


    <link rel="stylesheet" href="{{ STATIC_URL }}css/map/explore.css" />
{% endblock %}

{% block bodyid %}explore{% endblock %}

{% block primarynav %}
{% endblock %}

{% block content %}

    <div id="map">

    </div>
    <div id="minisplore">
        <h3>organization</h3>
        <div id="minisplore-wrapper">
                <ul>
                    {% for community in communities %}
                        <li><a class="community" href="{% url 'sherlock' exploring_state exploring_city community.id %}"
                               data-id="{{ community.neighborhood.id }}"
                               data-community="{{ community.id }}"
                                >{{ community.title }}</a></li>
                    {% endfor %}
                        <li><a href="#anywhere-else" id="anywhere-else">anywhere else</a></li>
                </ul>
        </div>
    </div>

    <article id="communisplore">

    </article>

    <select name="metrodifier" id="metrodifier">
        {% for metro in metros.list %}
            <option data-href="{% url 'explore' metro.1.lower metro.0.lower %}" value="{{ metro.0 }}"
                    {% if metro.0.lower == exploring_city and metro.1.lower == exploring_state %}selected{%  endif %}
                    >{{ metro.0 }}, {{ metro.1 }}</option>
        {% endfor %}
    </select>

    {% verbatim %}
    <script id="section-template" type="text/x-handlebars-template">
        <section data-longitude="{{ longitude }}" data-latitude="{{ latitude }}">
            <a href="{{ link }}">
                <h4>{{ name }}</h4>
            </a>
            <div class="extended">
                <p>{{ description }}</p>
                <div class="share">
                    <a class="orange buttonize" href="{{ add_idea }}">add idea</a>
                    <a class="blue buttonize" href="{{ find_ideas }}">find ideas</a>
                    <a class="blue buttonize" href="{{ share }}">share</a>
                </div>
                <div style="clear:both;"></div>
            </div>
        </section>
    </script>
    {% endverbatim %}

{% endblock %}

{% block footerscripts %}
    <script type="text/javascript">
    window.exploringMetro = "{{ exploring_city }}";
    </script>
    <script src='//api.tiles.mapbox.com/mapbox.js/v1.4.0/mapbox.js'></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/underscore-min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/plugins/baron.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/plugins/jcarousellite.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/plugins/typeahead.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/tb/tb-mapbox.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/tb/tb-explore.js"></script>

    {% if exploring %}
        <script type="text/javascript">
            minmin(
            {{ exploring.neighborhood.id }},
            {{ exploring.id }},
            '{{ exploring.get_absolute_url }}'
            );
        </script>
    {% endif %}

{% endblock %}